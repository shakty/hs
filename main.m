%% Stefano Balietti

%% Initialization of variables 
%Clear workspace
close all
clear
clc

%% Add other directories to path
path(path,'util/'); % Help functions
path(path,'lib/'); % Help functions

% Default Values

simName = 'Sim';
dumpDir = 'dump/';
confDir = 'conf/';

compLOCAL = 0;
compPARALLEL = 1;
compLSF = 2;

%% Loading Conf
% load([confDir 'NEW/attrLinear_nv_Kseed_rndseq_tm_Rleft_n200/attrLinear_nv_Kseed_rndseq_tm_Rleft_n200_s0']);
%load([confDir 'NEW/attrLinear_nv_Kseed_rndseq_tc_Rleft/attrLinear_nv_Kseed_rndseq_tc_Rleft_s0']);
load([confDir 'NEW/attrLinear_nv_rndseed_rndseq_tm_Rleft_n100_fv0/attrLinear_nv_rndseed_rndseq_tm_Rleft_n100_fv0_s0'])

%% Modifying params locally
VIDEO = 1;
DUMP = 0;
COMPUTATION = 0;
plottype = 0;
SHOW_POTENTIAL = 0;

% Scaling and nAgents
vScalings = 1;
n_agents = 100;

% Influence
alphas = 0.99;
Rs = 0.1;

% Noise
sigmas = 0.4;
noisetype = 1;

% Truth
taus = 0.1;
truths = [0.5;0.5];
attrtype = 2;
forces_on_v = 0;

% Seed
seedtype = 1;
%seed = 0;

%% Creating simName and Struct
simName = createSimName(simName,DUMP,dumpDir, 1);

simParamsStruct = struct( ...
                'dumpDir', dumpDir, ...
                'simName', simName, ...
                'VIDEO', VIDEO, ...
                'DEBUG', DEBUG, ...
                'DUMP', DUMP, ...
                'DUMP_RATE', DUMP_RATE, ...
                'nRuns', nRuns, ...
                'dts', dts, ...
                't_ends', t_ends, ...
                'n_agents', n_agents, ...
                'ideas_space_sizes', ideas_space_sizes, ...
                'ideas_space_dims', ideas_space_dims, ...
                'As', As, ...
                'Bs', Bs, ...
                'ks', ks, ...
                'd0s', d0s, ...
                'd1s', d1s, ...
                'alphas', alphas, ...
                'taus', taus, ...
                'Rs', Rs, ...
                'sigmas', sigmas, ...
                'v_scalings', vScalings, ...
                'nof_clusters', nClusters, ...
                'clusterTightness', clusterTightness, ...
                'truths', truths, ...
                'attrtype', attrtype, ...
                'noisetype', noisetype, ...
                'plottype', plottype, ...
                'SHOW_POTENTIAL', SHOW_POTENTIAL, ...
                'seedtype', seedtype, ...
                'seed', seed, ...
                'forces_on_v', forces_on_v ...
            );


%% Store a copy of input params in DIR if DUMP is required
if (DUMP)
    struct2File( simParamsStruct, dumpDir, simName);
end

%% Start Vectorization of Parameters Sets

switch (COMPUTATION)
    case compLSF
         param_sets_LSF (simParamsStruct);
        
%    case compPARALLEL
%        param_sets_parallel (dumpDir,simName,VIDEO,DEBUG,DUMP,...
%            nRuns, dts,t_ends,n_agents,ideas_space_sizes,ideas_space_dims,...
%            As,Bs,ks,d0s,d1s,alphas,taus,Rs,sigmas,...
%            vScalings,nClusters,clusterTightness,truths);
        
    case compLOCAL
        param_sets_local (simParamsStruct);
end

fprintf('\n%s: execution completed correctly\n', simParamsStruct.simName);
% Exit Matlab when invoked from command line with -r option
%exit
